<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Echo</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="apple-mobile-web-app-title" content="Echo">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">

    <style>
        /* CSS: The Visuals */
        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #000000; /* OLED Pure Black */
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: #333;
        }

        /* The Stealth Status Dot (Top Right) */
        #status-dot {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 6px;
            height: 6px;
            background-color: #ffa500; /* Offline Orange */
            border-radius: 50%;
            opacity: 0.4; /* Very dim */
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        /* The Reveal Text Container */
        #reveal-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 100%;
            pointer-events: none; /* Let clicks pass through */
        }

        /* The Revealed Word Style */
        #reveal-text {
            font-size: 3rem;
            font-weight: 300;
            letter-spacing: 4px;
            color: #666666; /* Ghost Grey */
            opacity: 0; /* Hidden by default */
            transition: opacity 2s ease-in; /* Slow fade in */
            text-transform: uppercase;
        }

        /* Debug/Feedback Flash (Optional: briefly lights up corner on input) */
        .feedback-flash {
            opacity: 1 !important;
        }
    </style>
</head>
<body>

    <div id="status-dot"></div>
    <div id="reveal-container">
        <div id="reveal-text"></div>
    </div>

    <script>
        // --- CONFIGURATION ---
        
        // The list of words you can reveal. 
        // Order matters! 
        // Code 0 (Left) -> "RED"
        // Code 1 (Right) -> "SEVEN"
        // Code 00 (Left, Left) -> "CIRCLE"
        // etc.
        const wordList = [
            "RED",      // Binary 0
            "SEVEN",    // Binary 1
            "CIRCLE",   // Binary 00
            "HOUSE",    // Binary 01
            "WATER",    // Binary 10
            "FIRE",     // Binary 11
            "PARIS",    // Binary 000
            "APPLE"     // Binary 001
        ];

        // --- STATE MANAGEMENT ---
        let inputSequence = ""; // Stores '0's and '1's
        let longPressTimer;
        let isRevealed = false;
        const LONG_PRESS_DURATION = 1000; // 1 second to trigger reveal

        // --- DOM ELEMENTS ---
        const statusDot = document.getElementById('status-dot');
        const revealText = document.getElementById('reveal-text');
        const body = document.body;

        // --- INPUT HANDLING ---

        body.addEventListener('touchstart', handleTouchStart, {passive: false});
        body.addEventListener('touchend', handleTouchEnd, {passive: false});
        
        // Also add mouse support for desktop testing
        body.addEventListener('mousedown', handleTouchStart);
        body.addEventListener('mouseup', handleTouchEnd);


        function handleTouchStart(e) {
            e.preventDefault();
            if (isRevealed) {
                resetApp();
                return;
            }

            // Start Long Press Timer (for Reveal)
            longPressTimer = setTimeout(triggerReveal, LONG_PRESS_DURATION);
            
            // Visual feedback (Tiny flash of the dot)
            statusDot.classList.add('feedback-flash');
        }

        function handleTouchEnd(e) {
            e.preventDefault();
            
            // Clear the Reveal Timer (if they let go before 1 second)
            clearTimeout(longPressTimer);
            statusDot.classList.remove('feedback-flash');

            // If we already revealed, do nothing (wait for next tap to reset)
            if (isRevealed) return;

            // Determine Click Position
            // Left Side = 0, Right Side = 1
            let clientX;
            if (e.type === 'touchend') {
                clientX = e.changedTouches[0].clientX;
            } else {
                clientX = e.clientX;
            }

            const screenWidth = window.innerWidth;
            
            if (clientX < screenWidth / 2) {
                inputSequence += "0";
                console.log("Input: 0 (Left)");
            } else {
                inputSequence += "1";
                console.log("Input: 1 (Right)");
            }
        }

        // --- CORE FUNCTIONS ---

        function triggerReveal() {
            // Convert binary sequence to integer index
            // e.g., "01" -> 1, "10" -> 2
            // Note: simple binary conversion: parseInt(string, 2)
            
            if (inputSequence === "") return; // No input, do nothing

            // Logic: Parse the binary string to get the index
            const index = parseInt(inputSequence, 2);

            if (index >= 0 && index < wordList.length) {
                showWord(wordList[index]);
            } else {
                showWord("???"); // Error/Out of bounds
            }
            
            isRevealed = true;
        }

        function showWord(word) {
            revealText.innerText = word;
            revealText.style.opacity = "1"; // Fade in
            statusDot.style.opacity = "0";  // Hide the dot for immersion
        }

        function resetApp() {
            // Reset everything to "Blackout" state
            revealText.style.opacity = "0";
            revealText.innerText = "";
            statusDot.style.opacity = "0.4";
            inputSequence = "";
            isRevealed = false;
        }

    </script>
</body>
</html>
